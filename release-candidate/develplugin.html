<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Radium Engine: How to write your own plugin</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSsymbols.js", "TeX/AMSmath.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="radium-logo.webp"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Radium Engine
   &#160;<span id="projectnumber">1.5.18</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('develplugin.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">How to write your own plugin</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#autotoc_md110">Radium Plugin</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md111">Setting a CMakeLists.txt for a Radium plugin</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md112">Configuring the plugin</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md113">Using the Plugin</a>
  </li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="autotoc_md110"></a>
Radium Plugin</h1>
<p>Tutorial and documentation here: <a href="https://github.com/STORM-IRIT/Radium-PluginExample">https://github.com/STORM-IRIT/Radium-PluginExample</a></p>
<p>In addition to the <a class="el" href="classRa_1_1Plugins_1_1RadiumPluginInterface.html" title="Interface class for Radiums plugins.">Ra::Plugins::RadiumPluginInterface</a> API, Radium provides a set of tools simplifying the deployment of plugins, which take care of the portability of the binaries.</p>
<p>This manual describes how to configure, compile and use your plugin with any Radium-Plugin compatible application.</p>
<h1><a class="anchor" id="autotoc_md111"></a>
Setting a CMakeLists.txt for a Radium plugin</h1>
<p>To compile and use a plugin, the Radium libraries must be configured, compiled and installed beforehand.</p>
<p>Example CMakeLists.txt setup to compile a Radium plugin:</p>
<div class="fragment"><div class="line"> cmake_minimum_required(VERSION 3.18)</div>
<div class="line"> #------------------------------------------------------------------------------</div>
<div class="line"> # Policies and global parameters for CMake</div>
<div class="line"> if (POLICY CMP0077)</div>
<div class="line">     cmake_policy(SET CMP0077 NEW)</div>
<div class="line"> endif ()</div>
<div class="line"> set(CMAKE_DISABLE_SOURCE_CHANGES ON)</div>
<div class="line"> set(CMAKE_DISABLE_IN_SOURCE_BUILD ON)</div>
<div class="line"> #------------------------------------------------------------------------------</div>
<div class="line"> # Project definition</div>
<div class="line"> project(MyPlugin VERSION 1.0.0 LANGUAGES CXX)</div>
<div class="line"> </div>
<div class="line"> # Use installed Radium environment</div>
<div class="line"> find_package(Radium REQUIRED Core Engine PluginBase)</div>
<div class="line"> </div>
<div class="line"># Find and configure Qt environment using find_qt_package is provided by Radium</div>
<div class="line"> find_qt_package(COMPONENTS Core REQUIRED)</div>
<div class="line"> set(Qt_LIBRARIES Qt::Core)</div>
<div class="line"> set(CMAKE_AUTOMOC ON)</div>
<div class="line"> set(CMAKE_AUTORCC ON)</div>
<div class="line"> </div>
<div class="line"> # list all the sources and headers of the Plugin</div>
<div class="line"> set(sources /*... */)</div>
<div class="line"> set(headers /*... */)</div>
<div class="line"> </div>
<div class="line"> set(CMAKE_INCLUDE_CURRENT_DIR ON)</div>
<div class="line"> </div>
<div class="line"> # A Plugin is a library that uses these sources and headers.</div>
<div class="line"> add_library( ${PROJECT_NAME} SHARED ${sources} ${headers} )</div>
<div class="line"> </div>
<div class="line"> target_include_directories(${PROJECT_NAME} PRIVATE ${CMAKE_CURRENT_SOURCE_DIR}/src)</div>
<div class="line"> target_compile_definitions(${PROJECT_NAME} PRIVATE &quot;-D${PROJECT_NAME}_EXPORTS&quot;)</div>
<div class="line"> </div>
<div class="line"> target_link_libraries(${PROJECT_NAME} PUBLIC</div>
<div class="line">                       Radium::Core Radium::Engine Radium::PluginBase</div>
<div class="line">                       ${Qt_LIBRARIES} )</div>
<div class="line"> </div>
<div class="line"> # Configure the plugin deployment using the Radium configuration tool</div>
<div class="line"> configure_radium_plugin( NAME ${PROJECT_NAME} )</div>
</div><!-- fragment --><p>Such a CMakeLists.txt is as usual as others. The only command that is specific to Radium plugins is the last line <code>configure_radium_plugin( NAME ${PROJECT_NAME} )</code> that aims at configuring the plugin installation along with its associated resources. This function is provided from <code>find_package(Radium REQUIRED Core Engine PluginBase)</code>, see <a class="el" href="cmakeutilities.html">Radium cmake utilities</a> documentation for more details.</p>
<p>The command <code>configure_radium_plugin</code>takes several parameters. The full usage of this command is :</p>
<div class="fragment"><div class="line">configure_radium_plugin(</div>
<div class="line">    NAME nameOfTheTargetOtInstall      # mandatory</div>
<div class="line">    INSTALL_IN_RADIUM_BUNDLE           # optional</div>
<div class="line">    RESOURCES ListOfResourcesDirectory # optional</div>
<div class="line">    HELPER_LIBS ListOfHelperLibraries  # optional</div>
<div class="line">     )</div>
</div><!-- fragment --><ul>
<li><code>NAME nameOfTheTargetOtInstall</code>. This parameter, mandatory, will configure how to install the target <code>nameOfTheTargetOtInstall</code>. This target must correspond to a configured target such the one obtained by <code>target_link_libraries(nameOfTheTargetOtInstall PUBLIC Radium::Core Radium::Engine Radium::PluginBase ${Qt_LIBRARIES} )</code></li>
<li><code>RESOURCES ListOfResourcesDirectory</code>. This parameter, optional, will install several resources, needed by the plugin for its correct execution, so that the Radium resource locator system will be able to find them. Resources could be shader source files, images, data files, etc...</li>
<li><code>HELPER_LIBS ListofHelperLibraries</code>. This parameter, optional, will allow fetching and install, alongside the plugin, libraries and their resources used by the plugin and not available in the Radium Bundle. This is useful when a plugin just defines the radium application interface toward services offered in an external, radium dependent, library.</li>
<li><code>INSTALL_IN_RADIUM_BUNDLE</code>. This parameter, optional, will install the plugin and its associated resources directly into the Radium Bundle installation directory. This will allow to have Plugins relocatable at the same time as the Radium Bundle. If this parameter is given, it replaces the installed location configuration that uses the cmake standard option <code>-DCMAKE_INSTALL_PREFIX=whereToInstallThings</code></li>
</ul>
<p>Note that, as it is the case for applications, Plugins does not need to be installed to be used by any applications. Plugins could be loaded and used from their build-trees.</p>
<h1><a class="anchor" id="autotoc_md112"></a>
Configuring the plugin</h1>
<p>Configuring the plugin for compilation and install depends on several use cases that might evolve during the plugin development.</p>
<p>There are three main uses cases we can identify :</p>
<ol type="1">
<li>You are developing/testing your plugin. There is no need to install the plugin and no install option is needed when configuring using cmake. Any plugin compatible application might find and use it from its build tree (e.g <code>build-release/Plugins</code>). For this, you have to configure once your application by adding the build path of the plugin to the plugin search path of the application. Each time you will launch this application, it will search in all its registered search paths for compatible plugins. The advantage of not installing plugins while developing/testing is a fast startup of the application and efficient update of the Plugin resources as Resources directories are <em>linked</em> (symbolic links on systems that support them) into the build tree.</li>
<li>You have finished developing the plugin, and will only occasionally recompile it for maintenance. If you developed several plugins, for your own usage, and you want your plugin compatible applications to find and load them quickly, you might install your plugins in one unique location and tell the applications to load plugins from there. To do so, use the cmake configuration option <code>-DCMAKE_INSTALL_PREFIX=thePathToTheInstalledPlugins</code> and do a <code>make install</code> You can then configure your applications so that they will search plugins from the <code>thePathToTheInstalledPlugins</code> directory. Each time the application will start, all the plugins from this <code>thePathToTheInstalledPlugins</code> will be loaded, even those installed here after the configuration of the plugin location in the application.</li>
<li>You want to distribute plugins binaries alongside the Radium bundle. In this case, you have to configure the plugin with the<code>INSTALL_IN_RADIUM_BUNDLE</code>option and do a <code>make install</code> to install the plugins in the Radium Bundle. Note that this requires write access to the Radium Bundle.</li>
</ol>
<p>Once you have chosen the adequate use case, you can configure the plugin using cmake.</p>
<p>As we disable "in source" build in the CMakeLists.txt example above, we need to create a build directory:</p>
<div class="fragment"><div class="line">mkdir build-release &amp;&amp; cd build-release</div>
</div><!-- fragment --><p>With Radium-Engine installed in the directory <code>pathToRadiumInstallation</code>, configure and compile the project with :</p>
<div class="fragment"><div class="line">cmake ../ -DRadium_DIR=pathToRadiumInstallation/lib/cmake/Radium</div>
<div class="line">cmake --build .</div>
</div><!-- fragment --><p>If you just want to use the plugin directly from its build-tree, the resulting dynamic library will be found in the <code>build-release/Plugins/lib</code> directory, and the associated resources will be linked (or copied on systems that do not support symbolic links) in the directory <code>build-release/Plugins/Resources</code>. In this case, note that the plugin from the build-tree could generally not be moved as it is linked to used libraries using relative paths.</p>
<p>If you install the plugin, execute the command <code>cmake --install</code> that will install the plugin according to your configuration choice as described above (default installation destination, user defined installation directory or Radium Bundle installation). The dynamic library will then be copied into <code>pathToInstallPlugins/lib</code> and the Resources will be copied into <code>pathToInstallPlugins/Resources</code>.</p>
<p>Remember that resources associated with the plugin using the option <code>RESOURCES ListOfResourcesDirectory</code> of the <code>configure_radium_plugin</code> command are <em>linked</em> into the build-tree (on systems supporting symbolic links) and <em>copied</em> into the installed locations.</p>
<h1><a class="anchor" id="autotoc_md113"></a>
Using the Plugin</h1>
<p>Any application that inherits from <code><a class="el" href="classRa_1_1Gui_1_1BaseApplication.html" title="This class contains the main application logic. It owns the engine and the GUI.">Ra::Gui::BaseApplication</a></code> could use any Plugin developed using the Radium Engine. As plugins are Qt objects that implement specific interface, it is also permitted to have any Qt Application to use plugins. Meanwhile, the following documentation is related to the Radium BaseApplication derived applications.</p>
<p>If the plugin is installed in the Radium Bundle directory, it will be automatically loaded by any plugin-aware application. Recall that, when developing a plugin, the installation in the Radium bundle directory is not always permitted nor efficient.</p>
<p>It could then be useful to use the Plugin from its own installation directory or directly from its build-tree. To do that, the application could register the plugin directory location by calling the <code><a class="el" href="classRa_1_1Gui_1_1BaseApplication.html#a02484e9e37b76e8f69fb59f984d54cbc" title="Allow the user to register a specific plugin directory for the application.">Ra::Gui::BaseApplication::addPluginDirectory</a>( const <a class="elRef" target="_blank" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>&amp; pluginDir );</code> method that will record, in the QSettings file associated with the application, the directory in which the Radium Engine will look for plugins. Once this directory is registered, any plugin that will be found in this directory will be loaded at each application startup if the build type of the plugin is compatible with the build type of the application (release, debug, ...). If the plugin location that is registered correspond to the build tree location of the plugin, there is no need to install it.</p>
<p>Note that the main Radium demonstration application (<code>main-app</code>) offer a menu entry (<code>File/Plugins/Add plugin path</code>) that call the registration method once the user has selected a plugin location. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="develmanual.html">Developer manual</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
